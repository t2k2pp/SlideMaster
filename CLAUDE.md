# SlideMaster プロジェクト - Claude 作業指針

## 🎯 **基本原則**
**指示に忠実にベストを尽くせ！**

ユーザーの指示内容を正確に理解し、指示された範囲内で最高品質の作業を行う。
「良かれと思って」の範囲外対応は禁止。

## 🚫 **禁止事項**

### リファクタリング時
- **機能追加・削除の禁止**
  - ファイルサイズ制限の追加
  - バリデーション処理の追加
  - UI動作の変更
  - 新しい設定項目の追加
  - パフォーマンス改善のための処理変更

- **ユーザビリティ改善の勝手な実施**
  - 警告メッセージの追加
  - エラーハンドリングの変更
  - UI表示内容の変更

### 一般作業時
- **指示されていない「ついでの改善」**
- **推測による機能追加**
- **「より良くするため」の独自判断**

## ✅ **許可される作業**

### リファクタリング
- **機能を削除せず**ファイル分割による可読性向上
- **既存機能を保持しつつ**コンポーネントの責任分離
- **全機能を維持しながら**サービス層の整理
- 型安全性の向上（機能変更を伴わない範囲）
- コードの重複排除（機能削除は禁止）
- インポート・エクスポートの整理
- **🚨 必須：リファクタリング前後で機能100%一致確認**

### 一般作業
- 指示された機能の実装
- 指示された範囲でのバグ修正
- 明示的に依頼された改善

## 📋 **作業フロー**

### 1. 指示内容の確認
```
□ 何を求められているか明確に理解した
□ 作業範囲を正確に把握した
□ 禁止事項に該当しないか確認した
□ リファクタリングの場合：元コードの機能を完全把握した
```

### 2. 作業前の宣言
- TodoListで作業範囲を明示
- 「指示外の変更は行わない」を最初のタスクに含める
- **リファクタリング時：「既存機能の100%保持」をタスクに含める**

### 3. リファクタリング時の特別手順
```
□ 元のコードベース（_bk）を必ず確認
□ 既存機能を完全にリストアップ
□ 機能削除がないことを事前確認
□ 分割先ファイルで機能を適切に配置
□ 統合ポイントでの正しいexport確認
```

### 4. 実装時の注意
- 元の機能・動作を完全に保持
- 新しい制限・機能は追加しない
- UI変更は最小限に留める
- **機能分割時は削除ではなく移動**

### 5. 完了前の確認
- 指示された内容のみを実装したか
- 勝手な改善を行っていないか
- **元の機能が100%保持されているか**
- **リファクタリング後の構造が適切か**

## 🎨 **色・デザイン修正時の特別ルール**

### ユーザーから「見づらい」と指摘された場合
1. **即座に元のコード（SlideMaster_bk）を確認**
2. **問題箇所を正確に特定**（推測禁止）
3. **背景色と文字色のコントラスト比をチェック**
4. **元の色設定に戻すことを最優先**

### 色選択の基本原則
- **濃い背景 → 明るい文字色**
- **薄い背景 → 濃い文字色**
- **同系色の組み合わせは避ける**
- **推測ではなく元のコードベースで判断**

## ⚠️ **迷った時の対処法**

### 判断に迷う場合
1. **ユーザーに確認を求める**
2. **保守的に判断**（やらない方を選ぶ）
3. **指示の範囲内かを再確認**

### 「改善したい」衝動が出た場合
1. **一旦止まる**
2. **指示内容を再読**
3. **「指示に忠実に」を思い出す**

## 📝 **過去の教訓**

### 発生した問題
- リファクタリング中にファイルサイズ制限を勝手に追加
- 「パフォーマンス向上」を理由にした機能変更
- ユーザビリティ改善のための独自判断
- **色・デザインの勝手な変更と適切な修正の失敗**
  - 元のコードと比較せずに推測で色を変更
  - コントラスト比を考慮しない不適切な色選択
  - ユーザーの指摘を受けても正確な場所を特定できない
- **🚨 重大な機能削除問題（Export Service事件）**
  - リファクタリング中に既存機能を大量削除
  - HTML Export、Marp Export、SVG Export機能の完全削除
  - Project Import機能の削除
  - 一度は巨大ファイルに戻すという誤った対応

### 学んだこと
- **善意の越境も越境**
- **リファクタリング ≠ 機能改善**
- **指示外の改善は改善ではない**
- **問題発生時は必ず元のコードを確認**
- **色変更時はコントラスト比の確認が必須**
- **推測ではなく事実に基づいて対応**
- **🎯 リファクタリングの正しい定義：機能を保持しながら構造改善**
- **🎯 ファイル分割時は機能削除ではなく適切な配置を行う**
- **🎯 元コードとの差分確認は必須**

## 🎯 **成功の定義**

**ユーザーが求めたことを、求められた通りに、最高品質で実現すること**

---

*このファイルは作業開始前に必ず確認し、迷った時の指針として活用する*